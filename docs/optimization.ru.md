title: Оптимизация
description: Методы оптимизации вашей установки GTA IV.
---
hide:
  - footer
---

# Оптимизация
Мы все знаем, насколько ужасной была оптимизация игры на момент выхода. К сожалению, у нас до сих пор нет идеального решения, но есть довольно хорошее.

## DXVK
На данный момент это единственное хорошее решение для повышения производительности игры. Несмотря на отсутствие официальной поддержки для Windows, он прекрасно работает с GTA IV начиная с версии 2.2 DXVK.

!!! warning ""
    Убедитесь, что ваш ПК соответствует [требованиям DXVK](https://github.com/doitsujin/dxvk/wiki/Driver-support "DXVK GitHub Wiki") или хотя бы [требования DXVK Legacy](https://github.com/doitsujin/dxvk/wiki/Driver-support#dxvk-1103 "DXVK's GitHub Wiki") - предпочтительно рекомендуемым версиям. Большинство видеокарт 2014 года и новее должны поддерживать обычную версию, а видеокарты 2012 года и новее - Legacy версию, но вы можете использовать вкладку Advanced в [GPU-Z](https://www.techpowerup.com/download/gpu-z/ "TechPowerUp GPU-Z) чтобы проверить самостоятельно. Legacy версия имеет меньшую производительность и может содержать больше ошибок.

??? warning "Поддержка ENB"
    DXVK официально не поддерживает [ENB](Graphics-Enhancement\ENB) (и наоборот) и настоятельно не рекомендуется сообществом ENB. Тем не менее, он будет работать для более простых эффектов, но при этом следует ожидать проблем.

    Не обращайте внимания, если не планируете использовать [ENB](Graphics-Enhancement\ENB)

### Какое улучшение мне ожидать?
Сложно сказать, поскольку улучшение DXVK может варьироваться от устройства к устройству. Но для приблизительного сравнения можно воспользоваться моим сравнением:
<iframe width="560" height="315" src="https://www.youtube.com/embed/mSSjw8uf5Rw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

### Установка
=== "Последняя версия"
    !!! warning ""
        Используйте эту версию, если ваша видеокарта поддерживает последнюю версию. Убедитесь в этом, ознакомившись с предупреждением выше.

    - Инструкции:
        * Перейдите на [релизы DXVK](https://github.com/doitsujin/dxvk/releases) и скачайте последнюю версию - :material-zip-box:`dxvk-x.x.tar.gz`.
        * После скачивания откройте архив и перейдите по :material-zip-box:==dxvk-x.x.tar\\dxvk-x.x\\x32\\==
        * Распакуйте :fontawesome-solid-gears:`d3d9.dll` в папку с игрой.
    
    ??? question "Почему не :fontawesome-solid-gears:`dxgi.dll` или другие файлы в папке?"
        Игра использует графический API Direct3D 9. Остальные dll предназначены для Direct3D 10 и Direct3D 11. 

        Проще говоря, игра не будет использовать никакие другие файлы.
    
    ??? question "Почему :material-folder:==x32==? У меня 64-битная система"
        Ваша система в данном случае не имеет значения. Сама игра рассчитана на использование 32-битных библиотек, а не 64-битных.

        Проще говоря, игра не будет использовать файлы из :material-folder:==x64==.
    
    ??? warning "Если у вас возникли проблемы..."
        Используйте версию 2.2 или 2.0 - это последние версии, которые подтвержденно работают идеально.
       
        Если игра вообще не запускается, значит, ваша видеокарта не поддерживает последнюю версию. Вместо нее используйте версию Legacy.
=== "Legacy версия"
    !!! warning ""
        Используйте эту версию только в том случае, если ваша видеокарта поддерживает только Legacy версию. Убедитесь в этом, ознакомившись с предупреждением выше.

    - Инструкции:
        * Перейдите на [релиз DXVK 1.10.3](https://github.com/doitsujin/dxvk/releases/tag/v1.10.3) и скачайте :material-zip-box:`dxvk-1.10.3.tar.gz`.
        !!! note ""
            Вы также можете использовать [DXVK-async 1.10.3](https://github.com/Sporif/dxvk-async/releases/tag/1.10.3) для более плавной игры.
        * После скачивания откройте архив и перейдите по :material-zip-box:==dxvk-1.10.3.tar_3\\dxvk-1.10.3\\x32\\==<br>Или :material-zip-box:==dxvk-async-1.10.3.tar_2\\dxvk-async-1.10.3\\x32\\==</br>
        * Распакуйте :fontawesome-solid-gears:`d3d9.dll` в папку с игрой.
    
    ??? question "Почему не :fontawesome-solid-gears:`dxgi.dll` или другие файлы в папке?"
        Игра использует графический API Direct3D 9. Остальные dll предназначены для Direct3D 10 и Direct3D 11. 

        Проще говоря, игра не будет использовать никакие другие файлы.
    
    ??? question "Почему :material-folder:==x32==? У меня 64-битная система"
        Ваша система в данном случае не имеет значения. Сама игра рассчитана на использование 32-битных библиотек, а не 64-битных.

        Проще говоря, игра не будет использовать файлы из :material-folder:==x64==.
    
    ??? warning "Если у вас возникли проблемы..."
        Если игра вообще не запускается, значит, ваша видеокарта не поддерживает DXVK.
    
### Настройка 
Создайте в папке с игрой файл :material-file-cog:`dxvk.conf` и добавьте в него с помощью любого текстового редактора следующие строки (взято из [PCGW](https://www.pcgamingwiki.com/wiki/Grand_Theft_Auto_IV#DXVK)):
``` { .py }
# maxFrameLatency используется для предотвращения или уменьшения случайных пропусков кадров и фризов. Эта опция устанавливает более строгую максимальную задержку кадров.
d3d9.maxFrameLatency = 1
# presentInterval используется для включения VSync. Мы будем использовать его в пользу игрового VSync. Так мы получим лучшую нагрузку на процессор.
d3d9.presentInterval = 1
# numBackBuffers может дополнительно улучшить стабильность FPS при использовании Vsync. Эта опция переопределяет количество обратных буферов для цепочки подкачки Vulkan.
d3d9.numBackBuffers = 3
```
??? abstract "Полный список настроек DXVK"
    Полный список можно посмотреть [здесь](https://github.com/doitsujin/dxvk/blob/master/dxvk.conf).

## DxWrapper
??? note "Что такое DxWrapper и как его использовать?"
    Некоторая часть сообщества GTA IV считает, что [DxWrapper](https://github.com/elishacloud/dxwrapper/releases/) может увеличить производительность. Из моих экспериментов следует, что использование `v1.0.6387.21` только ухудшило производительность и не дало никаких преимуществ. 
    
    Чтобы использовать его, извлеките :material-file:`dxwrapper.asi`, :material-file-edit:`dxwrapper.ini` и :fontawesome-solid-gears:`dxwrapper.dll`, и в :material-file-edit:`dxwrapper.ini` включите `DDrawCompat` и `DDrawCompatNoProcAffinity`.
    
    Если вы сможете мне доказать мне с помощью чётких сравнений, что это *может* повысить производительность, [свяжитесь со мной](contact-me.md).

[:material-page-first:Предыдущая страница <br>Введение</br>](index.md){ .md-button } [Следующая страница:material-page-last: <br>Второстепенная настройка</br>](Additional-Setup.md){ .md-button .md-button--primary }